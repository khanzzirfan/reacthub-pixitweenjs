{"version":3,"file":"PixiImageSprite-acbaa42a.js","sources":["../../src/hooks/withEffectsHook.tsx","../../src/components/PixiImageSprite/PixiImageSprite.tsx"],"sourcesContent":["import * as PIXI from \"pixi.js\";\r\n/// import * as PixiFilters from \"pixi-filters\";\r\n\r\nexport const withEffectsHooks = () => {\r\n  // Create a custom night vision filter\r\n  const nightVisionFilter = new PIXI.Filter(\r\n    // @ts-ignore\r\n    null,\r\n    `\r\n  precision mediump float;\r\n  uniform mat3 uNightVisionMatrix;\r\n  varying vec2 vTextureCoord;\r\n  uniform sampler2D uSampler;\r\n  \r\n  void main(void) {\r\n      vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n      vec3 color = texColor.rgb;\r\n      gl_FragColor = vec4(uNightVisionMatrix * vec3(color), texColor.a);\r\n  }\r\n`\r\n  );\r\n\r\n  // Define the night vision matrix\r\n  const nightVisionMatrix = [\r\n    0.393, 0.769, 0.189, 0.349, 0.686, 0.168, 0.272, 0.534, 0.131,\r\n  ];\r\n\r\n  // Set the matrix as a uniform for the filter\r\n  nightVisionFilter.uniforms.uNightVisionMatrix = nightVisionMatrix;\r\n\r\n  /// vignette filter effect\r\n  //   // Create a vignette filter\r\n  const vignetteFilter = new PIXI.Filter(\r\n    // @ts-ignore\r\n    null,\r\n    `\r\n    precision mediump float;\r\n    varying vec2 vTextureCoord;\r\n    uniform sampler2D uSampler;\r\n    uniform vec4 vignetteColor;\r\n    uniform float vignetteSize;\r\n    uniform float vignetteStrength;\r\n\r\n    void main(void) {\r\n      vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n      vec2 delta = vTextureCoord - vec2(0.5);\r\n      float vignette = 1.0 - smoothstep(vignetteSize, 0.5, length(delta));\r\n      gl_FragColor = texColor * vignetteColor * vignetteStrength * vignette;\r\n    }\r\n    `\r\n  );\r\n\r\n  // Set the vignette parameters\r\n  vignetteFilter.uniforms.vignetteColor = [0.0, 0.0, 0.0, 1.0]; // Black vignette\r\n  vignetteFilter.uniforms.vignetteSize = 0.7; // Adjust the size\r\n  vignetteFilter.uniforms.vignetteStrength = 0.6; // Adjust the strength\r\n\r\n  return {\r\n    nightVisionFilter,\r\n    vignetteFilter: vignetteFilter,\r\n  };\r\n};\r\n","import * as React from \"react\";\nimport { useRef } from \"react\";\nimport { Sprite, Container } from \"@pixi/react\";\nimport * as PIXI from \"pixi.js\";\n// @ts-ignore\nimport isEmpty from \"lodash/isEmpty\";\n// setup hocs\nimport AbstractContainer from \"../../hocs/AbstractContainer\";\nimport {\n  PixiBaseSpriteProps,\n  ForwardedRefResponse,\n} from \"../../types/BaseProps\";\nimport { withFiltersHook } from \"../../hooks/withFiltersHook\";\nimport { withEffectsHooks } from \"../../hooks/withEffectsHook\";\nimport { Effects } from \"../../types/Effects\";\n\nconst PixiImageSprite = React.forwardRef<\n  ForwardedRefResponse | null,\n  PixiBaseSpriteProps\n>((props, ref) => {\n  //// State\n  //// Refs\n  const imageRef = useRef<PIXI.Sprite>(null);\n  const imgGroupRef = useRef<PIXI.Container>(null);\n  //// Context\n\n  /// 1001\n  const {\n    src,\n    visible,\n    disabled,\n    transformation: {\n      x,\n      y,\n      width,\n      height,\n      anchor,\n      colorCorrection = {},\n      effect,\n    },\n    pointerdown,\n  } = props;\n\n  // log all props\n\n  const {\n    blurRadius = 0,\n    vignette = 0,\n    noise = 0,\n    // outline = 0,\n  } = colorCorrection;\n  // use with filters hoooks to get the filters\n  const {\n    temperatureFilter,\n    sharpnessFilter,\n    hueFilter,\n    blurFilter,\n    adjustmentFilter,\n    vignetteFilter,\n    noiseFilter,\n    // outlineFilter,\n  } = withFiltersHook(colorCorrection);\n\n  const { nightVisionFilter } = withEffectsHooks();\n\n  React.useEffect(() => {\n    return () => {\n      console.log(\"PixiImageSprite unmounting\");\n    };\n  }, []);\n\n  return (\n    <AbstractContainer {...props} ref={ref}>\n      <Container ref={imgGroupRef}>\n        <Sprite\n          image={src}\n          width={width}\n          height={height}\n          anchor={anchor}\n          ref={imageRef}\n          alpha={visible ? 1 : 0}\n          x={x}\n          y={y}\n          {...(!disabled &&\n            visible && { interactive: true, pointerdown: pointerdown })}\n          filters={[\n            temperatureFilter,\n            sharpnessFilter,\n            hueFilter,\n            adjustmentFilter,\n            // conditionally add blur filter\n            ...(blurRadius > 0 ? [blurFilter] : []),\n            // conditionally add night vision filter\n            ...(effect === Effects.NightVision ? [nightVisionFilter] : []),\n            // conditionally add vignette filter\n            ...(vignette > 0 ? [vignetteFilter] : []),\n            // conditionally add noise filter\n            ...(noise > 0 ? [noiseFilter] : []),\n            // conditionally add outline filter\n            // ...(outline > 0 ? [outlineFilter] : []),\n          ]}\n        />\n      </Container>\n    </AbstractContainer>\n  );\n});\n\nexport default PixiImageSprite;\n\n// @ts-ignore\nPixiImageSprite.whyDidYouRender = {\n  logOnDifferentValues: true,\n  customName: \"ImageSprite\",\n};\n"],"names":["withEffectsHooks","nightVisionFilter","PIXI.Filter","nightVisionMatrix","vignetteFilter","PixiImageSprite","React.forwardRef","props","ref","imageRef","useRef","imgGroupRef","src","visible","disabled","x","y","width","height","anchor","colorCorrection","effect","pointerdown","blurRadius","vignette","noise","temperatureFilter","sharpnessFilter","hueFilter","blurFilter","adjustmentFilter","noiseFilter","withFiltersHook","React.useEffect","jsx","AbstractContainer","Container","Sprite","Effects"],"mappings":"oMAGO,MAAMA,EAAmB,IAAM,CAE9B,MAAAC,EAAoB,IAAIC,EAE5B,KACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAA,EAeIC,EAAoB,CACxB,KAAO,KAAO,KAAO,KAAO,KAAO,KAAO,KAAO,KAAO,IAAA,EAI1DF,EAAkB,SAAS,mBAAqBE,EAI1C,MAAAC,EAAiB,IAAIF,EAEzB,KACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAA,EAkBF,OAAAE,EAAe,SAAS,cAAgB,CAAC,EAAK,EAAK,EAAK,CAAG,EAC3DA,EAAe,SAAS,aAAe,GACvCA,EAAe,SAAS,iBAAmB,GAEpC,CACL,kBAAAH,EACA,eAAAG,CAAA,CAEJ,EC7CAC,EAAAC,EAAA,WAAA,CAAAC,EAAAC,IAAA,CAME,MAAAC,EAAAC,SAAA,IAAA,EACAC,EAAAD,SAAA,IAAA,EAIA,CAAM,IAAAE,EACJ,QAAAC,EACA,SAAAC,EACA,eAAA,CACgB,EAAAC,EACd,EAAAC,EACA,MAAAC,EACA,OAAAC,EACA,OAAAC,EACA,gBAAAC,EAAA,CAAA,EACmB,OAAAC,CACnB,EACF,YAAAC,CACA,EAAAf,EAKF,CAAM,WAAAgB,EAAA,EACS,SAAAC,EAAA,EACF,MAAAC,EAAA,CACH,EAAAL,EAIV,CAAM,kBAAAM,EACJ,gBAAAC,EACA,UAAAC,EACA,WAAAC,EACA,iBAAAC,EACA,eAAA1B,EACA,YAAA2B,CACA,EAAAC,EAAAZ,CAAA,EAIF,CAAA,kBAAAnB,GAAAD,IAEAiC,OAAAA,EAAAA,UAAA,IACE,IAAA,CACE,QAAA,IAAA,4BAAA,CAAwC,EAC1C,CAAA,CAAA,EAGFC,EAAA,IAAAC,EAAA,CAAA,GAAA5B,EAAA,IAAAC,EAAA,SAAA0B,EAAA,IAAAE,EAAA,UAAA,CAAA,IAAAzB,EAAA,SAAAuB,EAAA,IAGMG,EAAA,OAAC,CAAA,MAAAzB,EACQ,MAAAK,EACP,OAAAC,EACA,OAAAC,EACA,IAAAV,EACK,MAAAI,EAAA,EAAA,EACgB,EAAAE,EACrB,EAAAC,EACA,GAAA,CAAAF,GAAAD,GAAA,CAAA,YAAA,GAAA,YAAAS,CAAA,EAE2D,QAAA,CAClDI,EACPC,EACAC,EACAE,EACA,GAAAP,EAAA,EAAA,CAAAM,CAAA,EAAA,CAAA,EAEqC,GAAAR,IAAAiB,EAAA,YAAA,CAAArC,CAAA,EAAA,CAAA,EAEuB,GAAAuB,EAAA,EAAA,CAAApB,CAAA,EAAA,CAAA,EAErB,GAAAqB,EAAA,EAAA,CAAAM,CAAA,EAAA,CAAA,CAEN,CAGnC,CAAA,CAAA,CAAA,CAAA,CAAA,CAKV,CAAA,EAKA1B,EAAA,gBAAA,CAAkC,qBAAA,GACV,WAAA,aAExB"}