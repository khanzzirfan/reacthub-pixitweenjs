import{r as E}from"./index-61bf1805.js";import{g as H}from"./_commonjsHelpers-de833af9.js";import{e as Y,f as K,a as z,h as U,U as X,j as G,k as Z,p as J,l as Q,s as ee,b as te,C as re,c as ne,S as ae,B as ie,V as se}from"./PixiStage-ce27c430.js";import{j as C}from"./jsx-runtime-4ca860c5.js";var oe=typeof Element<"u",de=typeof Map=="function",ue=typeof Set=="function",ce=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function P(r,e){if(r===e)return!0;if(r&&e&&typeof r=="object"&&typeof e=="object"){if(r.constructor!==e.constructor)return!1;var t,n,a;if(Array.isArray(r)){if(t=r.length,t!=e.length)return!1;for(n=t;n--!==0;)if(!P(r[n],e[n]))return!1;return!0}var i;if(de&&r instanceof Map&&e instanceof Map){if(r.size!==e.size)return!1;for(i=r.entries();!(n=i.next()).done;)if(!e.has(n.value[0]))return!1;for(i=r.entries();!(n=i.next()).done;)if(!P(n.value[1],e.get(n.value[0])))return!1;return!0}if(ue&&r instanceof Set&&e instanceof Set){if(r.size!==e.size)return!1;for(i=r.entries();!(n=i.next()).done;)if(!e.has(n.value[0]))return!1;return!0}if(ce&&ArrayBuffer.isView(r)&&ArrayBuffer.isView(e)){if(t=r.length,t!=e.length)return!1;for(n=t;n--!==0;)if(r[n]!==e[n])return!1;return!0}if(r.constructor===RegExp)return r.source===e.source&&r.flags===e.flags;if(r.valueOf!==Object.prototype.valueOf&&typeof r.valueOf=="function"&&typeof e.valueOf=="function")return r.valueOf()===e.valueOf();if(r.toString!==Object.prototype.toString&&typeof r.toString=="function"&&typeof e.toString=="function")return r.toString()===e.toString();if(a=Object.keys(r),t=a.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!Object.prototype.hasOwnProperty.call(e,a[n]))return!1;if(oe&&r instanceof Element)return!1;for(n=t;n--!==0;)if(!((a[n]==="_owner"||a[n]==="__v"||a[n]==="__o")&&r.$$typeof)&&!P(r[a[n]],e[a[n]]))return!1;return!0}return r!==r&&e!==e}var le=function(e,t){try{return P(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}};const fe=H(le),Ge=(r,e)=>{const t=E.useRef(!0),n=E.useRef(e);E.useEffect(()=>{const a=n.current.every((i,s)=>fe(i,e[s]));(t.current||!a)&&r(),t.current=!1,n.current=e},e)};var k={},L={},T={};Object.defineProperty(T,"__esModule",{value:!0});T.loop=T.conditional=T.parse=void 0;var pe=function r(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;if(Array.isArray(t))t.forEach(function(s){return r(e,s,n,a)});else if(typeof t=="function")t(e,n,a,r);else{var i=Object.keys(t)[0];Array.isArray(t[i])?(a[i]={},r(e,t[i],n,a[i])):a[i]=t[i](e,n,a,r)}return n};T.parse=pe;var he=function(e,t){return function(n,a,i,s){t(n,a,i)&&s(n,e,a,i)}};T.conditional=he;var ge=function(e,t){return function(n,a,i,s){for(var o=[],c=n.pos;t(n,a,i);){var f={};if(s(n,e,a,f),n.pos===c)break;c=n.pos,o.push(f)}return o}};T.loop=ge;var p={};Object.defineProperty(p,"__esModule",{value:!0});p.readBits=p.readArray=p.readUnsigned=p.readString=p.peekBytes=p.readBytes=p.peekByte=p.readByte=p.buildStream=void 0;var ve=function(e){return{data:e,pos:0}};p.buildStream=ve;var q=function(){return function(e){return e.data[e.pos++]}};p.readByte=q;var me=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(t){return t.data[t.pos+e]}};p.peekByte=me;var O=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};p.readBytes=O;var ye=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}};p.peekBytes=ye;var _e=function(e){return function(t){return Array.from(O(e)(t)).map(function(n){return String.fromCharCode(n)}).join("")}};p.readString=_e;var xe=function(e){return function(t){var n=O(2)(t);return e?(n[1]<<8)+n[0]:(n[0]<<8)+n[1]}};p.readUnsigned=xe;var we=function(e,t){return function(n,a,i){for(var s=typeof t=="function"?t(n,a,i):t,o=O(e),c=new Array(s),f=0;f<s;f++)c[f]=o(n);return c}};p.readArray=we;var Be=function(e,t,n){for(var a=0,i=0;i<n;i++)a+=e[t+i]&&Math.pow(2,n-i-1);return a},Se=function(e){return function(t){for(var n=q()(t),a=new Array(8),i=0;i<8;i++)a[7-i]=!!(n&1<<i);return Object.keys(e).reduce(function(s,o){var c=e[o];return c.length?s[o]=Be(a,c.index,c.length):s[o]=a[c.index],s},{})}};p.readBits=Se;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=T,t=p,n={blocks:function(d){for(var h=0,u=[],m=d.data.length,y=0,v=(0,t.readByte)()(d);v!==h&&v;v=(0,t.readByte)()(d)){if(d.pos+v>=m){var F=m-d.pos;u.push((0,t.readBytes)(F)(d)),y+=F;break}u.push((0,t.readBytes)(v)(d)),y+=v}for(var _=new Uint8Array(y),x=0,w=0;w<u.length;w++)_.set(u[w],x),x+=u[w].length;return _}},a=(0,e.conditional)({gce:[{codes:(0,t.readBytes)(2)},{byteSize:(0,t.readByte)()},{extras:(0,t.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,t.readUnsigned)(!0)},{transparentColorIndex:(0,t.readByte)()},{terminator:(0,t.readByte)()}]},function(l){var d=(0,t.peekBytes)(2)(l);return d[0]===33&&d[1]===249}),i=(0,e.conditional)({image:[{code:(0,t.readByte)()},{descriptor:[{left:(0,t.readUnsigned)(!0)},{top:(0,t.readUnsigned)(!0)},{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{lct:(0,t.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,e.conditional)({lct:(0,t.readArray)(3,function(l,d,h){return Math.pow(2,h.descriptor.lct.size+1)})},function(l,d,h){return h.descriptor.lct.exists}),{data:[{minCodeSize:(0,t.readByte)()},n]}]},function(l){return(0,t.peekByte)()(l)===44}),s=(0,e.conditional)({text:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{preData:function(d,h,u){return(0,t.readBytes)(u.text.blockSize)(d)}},n]},function(l){var d=(0,t.peekBytes)(2)(l);return d[0]===33&&d[1]===1}),o=(0,e.conditional)({application:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{id:function(d,h,u){return(0,t.readString)(u.blockSize)(d)}},n]},function(l){var d=(0,t.peekBytes)(2)(l);return d[0]===33&&d[1]===255}),c=(0,e.conditional)({comment:[{codes:(0,t.readBytes)(2)},n]},function(l){var d=(0,t.peekBytes)(2)(l);return d[0]===33&&d[1]===254}),f=[{header:[{signature:(0,t.readString)(3)},{version:(0,t.readString)(3)}]},{lsd:[{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{gct:(0,t.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,t.readByte)()},{pixelAspectRatio:(0,t.readByte)()}]},(0,e.conditional)({gct:(0,t.readArray)(3,function(l,d){return Math.pow(2,d.lsd.gct.size+1)})},function(l,d){return d.lsd.gct.exists}),{frames:(0,e.loop)([a,o,c,i,s],function(l){var d=(0,t.peekByte)()(l);return d===33||d===44})}],g=f;r.default=g})(L);var M={};Object.defineProperty(M,"__esModule",{value:!0});M.deinterlace=void 0;var Ce=function(e,t){for(var n=new Array(e.length),a=e.length/t,i=function(d,h){var u=e.slice(h*t,(h+1)*t);n.splice.apply(n,[d*t,t].concat(u))},s=[0,4,2,1],o=[8,8,4,2],c=0,f=0;f<4;f++)for(var g=s[f];g<a;g+=o[f])i(g,c),c++;return n};M.deinterlace=Ce;var D={};Object.defineProperty(D,"__esModule",{value:!0});D.lzw=void 0;var Te=function(e,t,n){var a=4096,i=-1,s=n,o,c,f,g,l,d,h,A,u,m,w,y,S,B,j,I,v=new Array(n),F=new Array(a),_=new Array(a),x=new Array(a+1);for(y=e,c=1<<y,l=c+1,o=c+2,h=i,g=y+1,f=(1<<g)-1,u=0;u<c;u++)F[u]=0,_[u]=u;var w,A,S,B,I,j;for(w=A=S=B=I=j=0,m=0;m<s;){if(B===0){if(A<g){w+=t[j]<<A,A+=8,j++;continue}if(u=w&f,w>>=g,A-=g,u>o||u==l)break;if(u==c){g=y+1,f=(1<<g)-1,o=c+2,h=i;continue}if(h==i){x[B++]=_[u],h=u,S=u;continue}for(d=u,u==o&&(x[B++]=S,u=h);u>c;)x[B++]=_[u],u=F[u];S=_[u]&255,x[B++]=S,o<a&&(F[o]=h,_[o]=S,o++,!(o&f)&&o<a&&(g++,f+=o)),h=d}B--,v[I++]=x[B],m++}for(m=I;m<s;m++)v[m]=0;return v};D.lzw=Te;Object.defineProperty(k,"__esModule",{value:!0});var $=k.decompressFrames=k.decompressFrame=V=k.parseGIF=void 0,Fe=je(L),Ae=T,ke=p,be=M,Ie=D;function je(r){return r&&r.__esModule?r:{default:r}}var Ue=function(e){var t=new Uint8Array(e);return(0,Ae.parse)((0,ke.buildStream)(t),Fe.default)},V=k.parseGIF=Ue,Ee=function(e){for(var t=e.pixels.length,n=new Uint8ClampedArray(t*4),a=0;a<t;a++){var i=a*4,s=e.pixels[a],o=e.colorTable[s]||[0,0,0];n[i]=o[0],n[i+1]=o[1],n[i+2]=o[2],n[i+3]=s!==e.transparentIndex?255:0}return n},N=function(e,t,n){if(!e.image){console.warn("gif frame does not have associated image.");return}var a=e.image,i=a.descriptor.width*a.descriptor.height,s=(0,Ie.lzw)(a.data.minCodeSize,a.data.blocks,i);a.descriptor.lct.interlaced&&(s=(0,be.deinterlace)(s,a.descriptor.width));var o={pixels:s,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return a.descriptor.lct&&a.descriptor.lct.exists?o.colorTable=a.lct:o.colorTable=t,e.gce&&(o.delay=(e.gce.delay||10)*10,o.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(o.transparentIndex=e.gce.transparentColorIndex)),n&&(o.patch=Ee(o)),o};k.decompressFrame=N;var Pe=function(e,t){return e.frames.filter(function(n){return n.image}).map(function(n){return N(n,e.gct,t)})};$=k.decompressFrames=Pe;const b=class extends K{constructor(r,e){super(z.EMPTY),this.animationSpeed=1,this.loop=!0,this.duration=0,this.autoPlay=!0,this.dirty=!1,this._currentFrame=0,this._autoUpdate=!1,this._isConnectedToTicker=!1,this._playing=!1,this._currentTime=0;const{scaleMode:t,width:n,height:a,...i}=Object.assign({},b.defaultOptions,e),s=document.createElement("canvas"),o=s.getContext("2d");s.width=n,s.height=a,this.texture=z.from(s,{scaleMode:t}),this.duration=r[r.length-1].end,this._frames=r,this._context=o,this._playing=!1,this._currentTime=0,this._isConnectedToTicker=!1,Object.assign(this,i),this.currentFrame=0,i.autoPlay&&this.play()}static fromBuffer(r,e){if(!r||r.byteLength===0)throw new Error("Invalid buffer");const t=m=>{let y=null;for(const v of m.frames)y=v.gce??y,"image"in v&&!("gce"in v)&&(v.gce=y)},n=V(r);t(n);const a=$(n,!0),i=[],s=document.createElement("canvas"),o=s.getContext("2d",{willReadFrequently:!0}),c=document.createElement("canvas"),f=c.getContext("2d");s.width=n.lsd.width,s.height=n.lsd.height;let g=0;const{fps:l}=Object.assign({},b.defaultOptions,e),d=1e3/l;for(let m=0;m<a.length;m++){const{disposalType:y=2,delay:v=d,patch:F,dims:{width:_,height:x,left:w,top:A}}=a[m];c.width=_,c.height=x,f.clearRect(0,0,_,x);const S=f.createImageData(_,x);S.data.set(F),f.putImageData(S,0,0),o.drawImage(c,w,A);const B=o.getImageData(0,0,s.width,s.height);(y===2||y===3)&&o.clearRect(0,0,s.width,s.height),i.push({start:g,end:g+v,imageData:B}),g+=v}s.width=s.height=0,c.width=c.height=0;const{width:h,height:u}=n.lsd;return new b(i,{width:h,height:u,...e})}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(U.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(U.shared.add(this.update,this,X.HIGH),this._isConnectedToTicker=!0),!this.loop&&this.currentFrame===this._frames.length-1&&(this._currentTime=0))}get progress(){return this._currentTime/this.duration}get playing(){return this._playing}update(r){var i,s;if(!this._playing)return;const e=this.animationSpeed*r/G.TARGET_FPMS,t=this._currentTime+e,n=t%this.duration,a=this._frames.findIndex(o=>o.start<=n&&o.end>n);t>=this.duration?this.loop?(this._currentTime=n,this.updateFrameIndex(a),(i=this.onLoop)==null||i.call(this)):(this._currentTime=this.duration,this.updateFrameIndex(this._frames.length-1),(s=this.onComplete)==null||s.call(this),this.stop()):(this._currentTime=n,this.updateFrameIndex(a))}updateFrame(){if(!this.dirty)return;const{imageData:r}=this._frames[this._currentFrame];this._context.putImageData(r,0,0),this._context.fillStyle="transparent",this._context.fillRect(0,0,0,1),this.texture.update(),this.dirty=!1}_render(r){this.updateFrame(),super._render(r)}_renderCanvas(r){this.updateFrame(),super._renderCanvas(r)}get autoUpdate(){return this._autoUpdate}set autoUpdate(r){r!==this._autoUpdate&&(this._autoUpdate=r,!this._autoUpdate&&this._isConnectedToTicker?(U.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(U.shared.add(this.update,this),this._isConnectedToTicker=!0))}get currentFrame(){return this._currentFrame}set currentFrame(r){this.updateFrameIndex(r),this._currentTime=this._frames[r].start}updateFrameIndex(r){var e;if(r<0||r>=this._frames.length)throw new Error(`Frame index out of range, expecting 0 to ${this.totalFrames}, got ${r}`);this._currentFrame!==r&&(this._currentFrame=r,this.dirty=!0,(e=this.onFrameChange)==null||e.call(this,r))}get totalFrames(){return this._frames.length}destroy(){this.stop(),super.destroy(!0);const r=null;this._context=r,this._frames=r,this.onComplete=r,this.onFrameChange=r,this.onLoop=r}clone(){return new b([...this._frames],{autoUpdate:this._autoUpdate,loop:this.loop,autoPlay:this.autoPlay,scaleMode:this.texture.baseTexture.scaleMode,animationSpeed:this.animationSpeed,width:this._context.canvas.width,height:this._context.canvas.height,onComplete:this.onComplete,onFrameChange:this.onFrameChange,onLoop:this.onLoop})}};let W=b;W.defaultOptions={scaleMode:Y.LINEAR,fps:30,loop:!0,animationSpeed:1,autoPlay:!0,autoUpdate:!0,onComplete:null,onFrameChange:null,onLoop:null};const Oe={extension:Z.Asset,detection:{test:async()=>!0,add:async r=>[...r,"gif"],remove:async r=>r.filter(e=>e!=="gif")},loader:{test:r=>J.extname(r)===".gif",load:async(r,e)=>{const n=await(await G.ADAPTER.fetch(r)).arrayBuffer();return W.fromBuffer(n,e==null?void 0:e.data)},unload:async r=>{r.destroy()}}};Q.add(Oe);const R=({children:r,backgroundColor:e})=>{const t=ee(e||"#2D2E3C"),n=600,a=500,i=E.useRef(null);return console.log("app wrapper updates with wrt timeline changes"),C.jsxs("div",{className:"App",children:[C.jsx("div",{id:"note-editor",ref:i}),C.jsx("div",{id:"toolbar"}),C.jsx("div",{id:"lottieroot"}),C.jsx(te,{children:C.jsx(re,{children:C.jsxs(ne,{flexDir:"column",children:[C.jsx(ae,{width:n,height:a,options:{backgroundColor:t,resolution:2},children:r}),C.jsx(ie,{mt:5,w:600,children:C.jsx(se,{})})]})})})]})};try{R.displayName="AppWrapper",R.__docgenInfo={description:"",displayName:"AppWrapper",props:{backgroundColor:{defaultValue:null,description:"",name:"backgroundColor",required:!1,type:{name:"string"}}}}}catch{}export{R as A,Ge as u};
//# sourceMappingURL=AppWrapper-b2060894.js.map
